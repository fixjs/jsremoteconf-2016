{"filter":false,"title":"2-1-generators.js","tooltip":"/2-1-generators.js","ace":{"folds":[],"customSyntax":"javascript","scrolltop":60,"scrollleft":0,"selection":{"start":{"row":14,"column":3},"end":{"row":14,"column":3},"isBackwards":false},"options":{"tabSize":2,"useSoftTabs":true,"guessTabSize":false,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":2,"state":"comment1","mode":"ace/mode/javascript"}},"hash":"58c1bedd2240afccb5bbdd6743d768050e1da832","changed":true,"value":"/*\n- Conflates the input with the output\n- Doesnt wotk with control flow primitivesxx\n- Error handling\n- and doing parallel operations\n*/\nvar fs = require('fs'),\n  awaitify = require('awaitify'),\n  present = require('present');\n\nfunction logDuration(startedAt, message) {\n  console.log(`>> ${message} >> duration: `, present() - startedAt);\n}\n\nfunction getJSONSync(fileName) {\n  // return JSON.parse(fs.readFileSync(fileName, 'utf-8'));\n  var startedAt = present();\n  var data = fs.readFileSync(fileName, 'utf-8');\n  logDuration(startedAt, 'getJSONSync');\n  return JSON.parse(data);\n}\n\n//async\nfunction getJSON(fileName, callback) {\n  return new Promise(function (resolve, reject) {\n    var startedAt = present();\n\n    function returnResopnse(err, data) {\n      if (err) {\n        return reject(err);\n      }\n      logDuration(startedAt, 'getJSON >> Promises');\n\n      // try {\n      //   data = JSON.parse(data);\n      // } catch (err) {\n      //   return reject(err);\n      // }\n      // resolve(data);\n\n      resolve(JSON.parse(data));\n    }\n\n    fs.readFile(fileName, 'utf-8', returnResopnse);\n  });\n}\n\nfunction callSync() {\n  try {\n    var data = getJSONSync('data/users.json');\n    console.log(data);\n  }\n  catch (err) {\n    console.error(err);\n  }\n}\n\nvar callAsync = awaitify(function* () {\n  try {\n    var data = yield getJSON('data/users.json');\n    console.log(data);\n  }\n  catch (err) {\n    console.error(err);\n  }\n});\n\nfunction aWeirdScenarioInSync() {\n  try {\n    var data = getJSONSync('data/users.json');\n    var randomUser = getRandomUser(data);\n    var privateInfo = getJSONSync(getRandomUserFileAddress(randomUser));\n    var popularSeries = getJSONSync('data/popular-series.json');\n    logUserPopularSeries(randomUser, privateInfo, popularSeries);\n  }\n  catch (err) {\n    console.error(err);\n  }\n}\n\nvar aCoolAsyncScenario = awaitify(function* () {\n  try {\n    var data = yield getJSON('data/users.json');\n    var randomUser = getRandomUser(data);\n    var privateInfo = yield getJSON(getRandomUserFileAddress(randomUser));\n    var popularSeries = yield getJSON('data/popular-series.json');\n    logUserPopularSeries(randomUser, privateInfo, popularSeries);\n  }\n  catch (e) {\n    console.error(err);\n  }\n});\n\nfunction getRandomUser(data) {\n  return data[Math.floor(Math.random() * data.length)];\n}\n\nfunction getRandomUserFileAddress(randomUser) {\n  return 'data/' + randomUser.firstName.toLowerCase() + '-' + randomUser.lastName.toLowerCase() + '.json';\n}\n\n\nfunction logUserPopularSeries(user, privateInfo, popularSeries) {\n  var birthYear = new Date(privateInfo.birthDate).getFullYear();\n  console.log('User: ', user.firstName + ' ' + user.lastName);\n  if (typeof popularSeries[birthYear] === 'undefined') {\n    return console.log('WOW At your birthDate TV Series has not been invented yet! :) Just kidding data is not availble for :' + birthYear);\n  }\n  console.log('Birth year:', birthYear);\n  console.log('Popular Series of this year was: \"' + popularSeries[birthYear] + '\"');\n}\n\n// callSync();\n// callAsync();\n// aWeirdScenarioInSync();\naCoolAsyncScenario();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction test() {\n  var startedAt = present();\n  aWeirdScenarioInSync();\n  aWeirdScenarioInSync();\n  aWeirdScenarioInSync();\n  aWeirdScenarioInSync();\n  aWeirdScenarioInSync();\n  aWeirdScenarioInSync();\n  aWeirdScenarioInSync();\n\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n  // aCoolAsyncScenario();\n\n  console.log('>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>');\n  console.log('The control flow is DONE, how long it took:', present() - startedAt);\n  console.log('>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>');\n}\n\n// test();\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"timestamp":1457828802000}